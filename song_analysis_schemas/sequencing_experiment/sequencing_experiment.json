{
    "name": "sequencing_experiment",
    "version": 3,
    "schema": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "id": "analysisPayload",
        "type": "object",
        "definitions": {
            "common": {
                "md5": {
                    "type": "string",
                    "pattern": "^[a-fA-F0-9]{32}$"
                },
                "submitterId": {
                    "type": "string"
                },
                "info": {
                    "type": "object"
                }
            },
            "file": {
                "fileType": {
                    "type": "string",
                    "enum": [
                        "FASTA",
                        "FAI",
                        "FASTQ",
                        "BAM",
                        "BAI",
                        "VCF",
                        "TBI",
                        "IDX",
                        "XML",
                        "TGZ"
                    ]
                },
                "fileData": {
                    "type": "object",
                    "required": [
                        "fileName",
                        "fileSize",
                        "fileType",
                        "fileAccess",
                        "fileMd5sum"
                    ],
                    "properties": {
                        "fileName": {
                            "type": "string",
                            "pattern": "^[A-Za-z0-9_\\.\\-\\[\\]\\(\\)]+$"
                        },
                        "fileSize": {
                            "type": "integer",
                            "min": 0
                        },
                        "fileAccess": {
                            "type": "string",
                            "enum": [
                                "open",
                                "controlled"
                            ]
                        },
                        "fileType": {
                            "$ref": "#/definitions/file/fileType"
                        },
                        "fileMd5sum": {
                            "$ref": "#/definitions/common/md5"
                        },
                        "info": {
                            "$ref": "#/definitions/common/info"
                        }
                    }
                }
            },
            "donor": {
                "donorGender": {
                    "type": "string",
                    "enum": [
                        "male",
                        "female",
                        "unspecified"
                    ]
                },
                "donorData": {
                    "type": "object",
                    "required": [
                        "donorSubmitterId",
                        "donorGender"
                    ],
                    "properties": {
                        "donorSubmitterId": {
                            "$ref": "#/definitions/common/submitterId"
                        },
                        "donorGender": {
                            "$ref": "#/definitions/donor/donorGender"
                        },
                        "info": {
                            "$ref": "#/definitions/common/info"
                        }
                    }
                }
            },
            "specimen": {
                "specimenType": {
                    "type": "string",
                    "enum": [
                        "Normal - solid tissue",
                        "Normal - blood derived",
                        "Normal - bone marrow",
                        "Normal - tissue adjacent to primary",
                        "Normal - buccal cell",
                        "Normal - EBV immortalized",
                        "Normal - lymph node",
                        "Normal - other",
                        "Primary tumour - solid tissue",
                        "Primary tumour - blood derived (peripheral blood)",
                        "Primary tumour - blood derived (bone marrow)",
                        "Primary tumour - additional new primary",
                        "Primary tumour - other",
                        "Recurrent tumour - solid tissue",
                        "Recurrent tumour - blood derived (peripheral blood)",
                        "Recurrent tumour - blood derived (bone marrow)",
                        "Recurrent tumour - other",
                        "Metastatic tumour - NOS",
                        "Metastatic tumour - lymph node",
                        "Metastatic tumour - metastasis local to lymph node",
                        "Metastatic tumour - metastasis to distant location",
                        "Metastatic tumour - additional metastatic",
                        "Xenograft - derived from primary tumour",
                        "Xenograft - derived from tumour cell line",
                        "Cell line - derived from tumour",
                        "Primary tumour - lymph node",
                        "Metastatic tumour - other",
                        "Cell line - derived from xenograft tumour"
                    ]
                },
                "specimenClass": {
                    "type": "string",
                    "enum": [
                        "Normal",
                        "Tumour",
                        "Adjacent normal"
                    ]
                },
                "specimenData": {
                    "type": "object",
                    "required": [
                        "specimenSubmitterId",
                        "specimenClass",
                        "specimenType"
                    ],
                    "properties": {
                        "specimenSubmitterId": {
                            "$ref": "#/definitions/common/submitterId"
                        },
                        "specimenClass": {
                            "$ref": "#/definitions/specimen/specimenClass"
                        },
                        "specimenType": {
                            "$ref": "#/definitions/specimen/specimenType"
                        },
                        "info": {
                            "$ref": "#/definitions/common/info"
                        }
                    }
                }
            },
            "analysisType": {
                "type": "object",
                "required": [
                    "name"
                ],
                "properties": {
                    "name": {
                        "type": "string"
                    },
                    "version": {
                        "type": [
                            "integer",
                            "null"
                        ]
                    }
                }
            },
            "sample": {
                "sampleTypes": {
                    "type": "string",
                    "enum": [
                        "DNA",
                        "FFPE DNA",
                        "Amplified DNA",
                        "RNA",
                        "Total RNA",
                        "FFPE RNA"
                    ]
                },
                "sampleData": {
                    "type": "object",
                    "required": [
                        "sampleSubmitterId",
                        "sampleType"
                    ],
                    "properties": {
                        "sampleSubmitterId": {
                            "$ref": "#/definitions/common/submitterId"
                        },
                        "sampleType": {
                            "$ref": "#/definitions/sample/sampleTypes"
                        },
                        "info": {
                            "$ref": "#/definitions/common/info"
                        }
                    }
                }
            }
        },
        "required": [
            "study",
            "analysisType",
            "sample",
            "file",
            "program_id",
            "submitter_sequencing_experiment_id",
            "sequencing_center",
            "platform",
            "platform_model",
            "library_strategy",
            "sequencing_date",
            "read_group_count",
            "read_group",
            "experiment",
            "workflow"
        ],
        "properties": {
            "study": {
                "type": "string",
                "minLength": 1
            },
            "analysisType": {
                "allOf": [
                    {
                        "$ref": "#/definitions/analysisType"
                    }
                ]
            },
            "sample": {
                "type": "array",
                "minItems": 1,
                "items": {
                    "type": "object",
                    "allOf": [
                        {
                            "$ref": "#/definitions/sample/sampleData"
                        }
                    ],
                    "required": [
                        "specimen",
                        "donor"
                    ],
                    "properties": {
                        "specimen": {
                            "$ref": "#/definitions/specimen/specimenData"
                        },
                        "donor": {
                            "$ref": "#/definitions/donor/donorData"
                        }
                    }
                }
            },
            "file": {
                "type": "array",
                "minItems": 1,
                "items": {
                    "$ref": "#/definitions/file/fileData"
                }
            },
            "platform": {
                "enum": [
                    "Illumina",
                    "SOLiD",
                    "LS454",
                    "PacBio",
                    "Ion Torrent",
                    "Nanopore",
                    "Complete Genomics"
                ]
            },
            "workflow": {
                "type": "object",
                "properties": {
                    "name": {
                        "type": "string"
                    },
                    "version": {
                        "type": "string"
                    },
                    "short_name": {
                        "type": "string"
                    }
                }
            },
            "experiment": {
                "type": "object"
            },
            "program_id": {
                "enum": [
                    "PACA-CA",
                    "PRAD-CA",
                    "PBCA-DE",
                    "PRAD-UK",
                    "OV-AU",
                    "CELL-LINE",
                    "TEST-PRO"
                ]
            },
            "read_group": {
                "type": "array",
                "items": {
                    "type": "object",
                    "minItems": 1,
                    "required": [
                        "submitter_read_group_id",
                        "platform_unit",
                        "library_name",
                        "is_paired_end",
                        "read_length_r1"
                    ],
                    "properties": {
                        "insert_size": {
                            "type": [
                                "integer",
                                "null"
                            ],
                            "minimum": 0
                        },
                        "library_name": {
                            "type": "string"
                        },
                        "is_paired_end": {
                            "type": "boolean"
                        },
                        "platform_unit": {
                            "type": "string"
                        },
                        "read_length_r1": {
                            "type": "integer",
                            "minimum": 20
                        },
                        "read_length_r2": {
                            "type": [
                                "integer",
                                "null"
                            ],
                            "minimum": 20
                        },
                        "sample_barcode": {
                            "type": [
                                "string",
                                "null"
                            ]
                        },
                        "submitter_read_group_id": {
                            "type": "string",
                            "description": "Submitter's read group ID. ID in BAM @RG header"
                        }
                    }
                }
            },
            "platform_model": {
                "enum": [
                    "HiSeq 2000",
                    "HiSeq 2500"
                ],
                "type": "string"
            },
            "sequencing_date": {
                "type": "string",
                "format": "date",
                "example": "2019-06-16"
            },
            "library_strategy": {
                "enum": [
                    "WGS",
                    "WXS",
                    "RNA-Seq",
                    "Bisulfite-Seq",
                    "ChIP-Seq"
                ]
            },
            "read_group_count": {
                "type": "integer",
                "minimum": 1
            },
            "sequencing_center": {
                "type": "string"
            },
            "submitter_sequencing_experiment_id": {
                "type": "string",
                "pattern": "^[a-zA-Z0-9]{1}[a-zA-Z0-9-_.:']{0,98}[a-zA-Z0-9]{1}$"
            }
        }
    }
}
